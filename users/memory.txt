Adjusting Client Memory Requirements
====================================

By default, the OMERO clients allocate a certain amount of memory for
themselves during the start-up process which should be sufficient for
most uses. However, when dealing with very large images, you may
encounter out of memory exceptions while trying to import or display
these large images. In these situations, it is beneficial to increase
the memory allocation to the clients as outlined below.

.. note::
    Increasing the memory of your client applications depends on the operating system and the client used. Also note
    that this guide does **not** cover OMERO.web, which uses a different
    server-based configuration set-up.

Macintosh Importer & Insight
----------------------------


-   Locate the ``OMERO.importer.app`` or ``OMERO.insight.app`` and right
    click (or control+click) on it, choose ''Show Package Contents''

.. image:: /images/memory_mac01.png
    :align: center

-   Navigate to the ``Contents`` folder
-   Right-click on the ``Info.plist`` file, this should open the file in
    the either Xcode if installed, or the Property List Editor

.. image:: /images/memory_mac02.png
    :align: center

-   Within Xcode/Property List Editor, click and open the ``Java`` node
-   Under ``VMOptions``, you will see a line such as ``-Xmx1024M``. This
    means you currently have 1024 Megabytes reserved for the application to
    use. Increase this to something like ``-Xmx2048M`` if you wish to
    increase the allocated size to 2048 Megabytes

.. image:: /images/memory_mac03.png
    :align: center

Windows Importer & Insight
--------------------------

-   To alter the memory allocation of the Windows clients, you must add
    an optional parameter file to the same folder as the application. For
    the ``OMERO.importer.exe`` (resp. ``OMERO.insight.exe``) application, this file should be named
    ``OMERO.importer.vmoptions`` (resp. ``OMERO.insight.vmoptions``).
-   The easiest way to get this file is to download either the
    :omero_plone:`OMERO.insight <clients/support-files/OMERO.insight.vmoptions>` or
    :omero_plone:`OMERO.importer <clients/support-files/OMERO.importer.vmoptions>`
    file attachment to this document, and copy it into the same directory
    as your ``.exe`` file (either ``OMERO.importer.exe`` or
    ``OMERO.insight.exe``). The default file increases the memory
    allocation to 2048 Megabytes, however you may if you choose, open the
    file in any text editor (such as notepad.exe) and change the value as
    described in the 'Macintosh Importer & Insight' entry above.

.. image:: /images/memory_win.png
    :align: center

Unix/Linux Importer & Insight
-----------------------------

-   Changing either the importer or insight memory allocation under Unix
    requires you to edit the start-up script located with the clients
    (either ``importer-cli``, ``OMEROimporter_unix.sh``, or
    ``OMEROinsight_unix.sh`` file).
-   For Insight and Importer GUI, you will need to edit the
    ``OMEROinsight_unix.sh`` or ``OMEROimporter_unix.sh`` file
    respectively and change the
    ``java -Xms256000000 -Xmx1024000000 -jar omero.insight.jar`` line with
    new minimum and preferred memory options (see the Java online
    documentation
    `here <http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/java.html>`_
    for a full description of these options).
-   For the Importer CLI, the required memory requirements are listed
    near the top of the ``importer-cli`` script, and should look like
    this: ``JAVA_ARGS="-Xmx1024M"``. Simply update the value to a larger
    number (as described in the Macintosh Importer & Insight' entry
    above).

.. image:: /images/memory_unix.png
    :align: center
